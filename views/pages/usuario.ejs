
<!DOCTYPE html>
<html lang="es">

<head>
  <%- include('../partials/head'); %>
</head>
<body>
  <header>
    <%- include('../partials/header'); %>
  </header>
  <main style="height:100%; padding:65px">
    <div class="container" style="padding: 10px;">
      <div class="row justify-content-center">
        <div class="col-md-6 col-sm-8">
          <div class="card form-container">
            <div class="card-header bg-warning ">              <h3 class="text-center">Inicio de Sesión</h3>
            </div>
            <div class="card-body" style="background-color: rgb(137, 43, 226);">
              <form id="loginForm" action="/auth/login" method="post">
                <div class="form-group">
                  <input type="email" name="email"  class="form-control" id="email" placeholder="Ingrese su correo electrónico">
                </div>
                <br>
                <div class="form-group">
                  <input type="password" name="contraseña"  class="form-control" id="password" placeholder="Ingrese su contraseña">
                </div>
                <br>
                <div style="padding:4px;">
                  <button type="submit" class="btn btn-warning btn-block" >Iniciar Sesión</button>
                </div>
                <br>
                <p>"Si olvidaste tu contraseña, puedes restablecerla haciendo clic en el siguiente enlace:"</p>
                <a href="recuperar_contraseña.php" style="color:yellow">Recuperar Contraseña</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    
  </form>
  
</main>
<div class="bg-dark py-3">
  <%- include('../partials/training'); %>  
</div>
<footer class="bg-dark py-3">
  <%- include('../partials/footer'); %>
</footer>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous">
  </script>
  <script>
    function login() {
        const email = document.getElementById('email').value;
        const contraseña = document.getElementById('password').value; // Corregido a 'password'

        fetch('/auth/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ email, password })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Inicio de sesión fallido');
            }
            return response.json();
        })
        .then(data => {
            // Almacenar el token en localStorage o cookies (ejemplo con localStorage)
            localStorage.setItem('token', data.token);

            // Redirigir a la página indicada por el servidor
            window.location.href = data.redirect;
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Inicio de sesión fallido');
        });
    }
</script>
</html>